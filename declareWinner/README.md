need to go to bed

this is mostly working, but there is a logic fault somewhere.  it's not switching to the right first attacker, and there is a shitload of duplicated code that I probably don't need.